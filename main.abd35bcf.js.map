{"version":3,"sources":["scripts/main.js"],"names":["tbody","document","querySelector","tBodies","children","allCell","querySelectorAll","startGame","blockScore","youWin","youLose","messStart","width","score","allEmptyCell","countBusyCell","oldArray","randomCell","matrix","rotateMatrix","arrMatrix","map","row","i","val","j","length","generateRandomInteger","min","max","rand","Math","random","round","render","y","k","innerHTML","addOrRemoveClass","generateNumInCell","newDiv","createElement","push","x","youLoseNow","classList","remove","textContent","className","add","forEach","item","innerText","combineRowRight","clickArrowRight","undefined","totalValue","parseInt","isYouWin","totalOne","filteredRow","filter","missing","newRow","Array","fill","concat","lookChanged","t","cleanTable","keyRight","keyLeft","keyUp","keyDown","addEventListener","setAttribute","event","eventCode","code"],"mappings":"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","file":"main.abd35bcf.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\n\nconst tbody = document.querySelector('table').tBodies[0].children;\nconst allCell = document.querySelectorAll('td');\nconst startGame = document.querySelector('.start');\nconst blockScore = document.querySelector('.game-score');\nconst youWin = document.querySelector('.message-win');\nconst youLose = document.querySelector('.message-lose');\nconst messStart = document.querySelector('.message-start');\nconst width = 4;\nlet score = 0;\nlet allEmptyCell = [];\nlet countBusyCell = false;\nlet oldArray = [];\nlet randomCell = 0;\nlet matrix = [\n  ['', '', '', ''],\n  ['', '', '', ''],\n  ['', '', '', ''],\n  ['', '', '', ''],\n];\n\nconst rotateMatrix = arrMatrix => {\n  matrix = arrMatrix.map((row, i) =>\n    row.map((val, j) => arrMatrix[arrMatrix.length - 1 - j][i])\n  );\n\n  return matrix;\n};\n\nfunction generateRandomInteger(min, max) {\n  const rand = min - 0.5 + Math.random() * (max - min + 1);\n\n  if (max === 1) {\n    return 0;\n  }\n\n  return Math.round(rand);\n}\n\nfunction render() {\n  for (let y = 0; y < matrix.length; y++) {\n    for (let k = 0; k < matrix[y].length; k++) {\n      tbody[y].children[k].innerHTML = matrix[y][k];\n    }\n  }\n  addOrRemoveClass();\n}\n\nfunction generateNumInCell() {\n  const newDiv = document.createElement('div');\n\n  for (let i = 0; i < matrix.length; i++) {\n    for (let j = 0; j < matrix[i].length; j++) {\n      if (matrix[i][j] === '') {\n        allEmptyCell.push({\n          x: i,\n          y: j,\n        });\n      }\n    }\n  }\n\n  if (youLoseNow() && allEmptyCell.length === 0) {\n    youLose.classList.remove('hidden');\n  }\n\n  if (countBusyCell) {\n    return;\n  }\n\n  randomCell = generateRandomInteger(0, allEmptyCell.length - 1);\n\n  matrix[allEmptyCell[randomCell].x][allEmptyCell[randomCell].y]\n  = Math.random() >= 0.9 ? 4 : 2;\n\n  newDiv.textContent\n  = matrix[allEmptyCell[randomCell].x][allEmptyCell[randomCell].y];\n\n  tbody[allEmptyCell[randomCell].x]\n    .children[allEmptyCell[randomCell].y].innerHTML\n  = matrix[allEmptyCell[randomCell].x][allEmptyCell[randomCell].y];\n\n  if (newDiv.textContent === '4') {\n    tbody[allEmptyCell[randomCell].x]\n      .children[allEmptyCell[randomCell].y].className = 'field-cell';\n\n    tbody[allEmptyCell[randomCell].x]\n      .children[allEmptyCell[randomCell].y].classList.add('field-cell--4');\n  } else {\n    tbody[allEmptyCell[randomCell].x]\n      .children[allEmptyCell[randomCell].y].className = 'field-cell';\n\n    tbody[allEmptyCell[randomCell].x]\n      .children[allEmptyCell[randomCell].y].classList.add('field-cell--2');\n  }\n\n  allEmptyCell = [];\n  oldArray = [];\n  allCell.forEach(item => oldArray.push(item.innerText));\n};\n\nfunction combineRowRight() {\n  clickArrowRight();\n\n  for (let y = matrix.length - 1; y >= 0; y--) {\n    for (let k = matrix[y].length - 1; k >= 0; k--) {\n      if (matrix[y][k - 1] === undefined) {\n        break;\n      }\n\n      if (matrix[y][k] === matrix[y][k - 1]\n        && matrix[y][k] !== '') {\n        const totalValue = parseInt(matrix[y][k])\n        + parseInt(matrix[y][k - 1]);\n\n        score += totalValue;\n        blockScore.innerText = score;\n\n        isYouWin();\n\n        matrix[y][k] = totalValue;\n        matrix[y][k - 1] = '';\n      } else {\n        continue;\n      }\n    }\n  }\n  clickArrowRight();\n}\n\nfunction clickArrowRight() {\n  for (let i = 0; i < matrix.length; i++) {\n    for (let j = 0; j < matrix[i].length; j++) {\n      if (j % 4 === 0) {\n        const totalOne = matrix[i][j];\n        const totalTwo = matrix[i][j + 1];\n        const totalThree = matrix[i][j + 2];\n        const totalFour = matrix[i][j + 3];\n\n        const Row = [totalOne, totalTwo, totalThree, totalFour];\n\n        const filteredRow = Row.filter(item => item);\n        const missing = width - filteredRow.length;\n        const empty = new Array(missing).fill('');\n\n        const newRow = empty.concat(filteredRow);\n\n        matrix[i][j] = newRow[0];\n        matrix[i][j + 1] = newRow[1];\n        matrix[i][j + 2] = newRow[2];\n        matrix[i][j + 3] = newRow[3];\n      }\n    }\n  }\n}\n\nfunction addOrRemoveClass() {\n  for (let k = 0; k < allCell.length; k++) {\n    // console.log(allCell)\n    allCell[k].className = 'field-cell';\n\n    allCell[k] === ''\n      ? allCell[k].className = 'field-cell'\n      : allCell[k].classList.add(`field-cell--${allCell[k].innerText}`);\n  }\n}\n\nstartGame.addEventListener('click', () => {\n  messStart.setAttribute('hidden', 'hidden');\n  startGame.innerText = 'Restart';\n  startGame.classList.remove('start');\n  startGame.classList.add('restart');\n  youLose.classList.add('hidden');\n  youWin.classList.add('hidden');\n  score = 0;\n  blockScore.innerText = score;\n  cleanTable();\n  render();\n  countBusyCell = false;\n  generateNumInCell();\n  generateNumInCell();\n});\n\nfunction lookChanged() {\n  for (let t = 0; t < oldArray.length; t++) {\n    if (oldArray[t] === allCell[t].innerText) {\n      continue;\n    } else {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction cleanTable() {\n  for (let i = 0; i < matrix.length; i++) {\n    for (let j = 0; j < matrix[i].length; j++) {\n      matrix[i][j] = '';\n    }\n  }\n}\n\nfunction youLoseNow() {\n  for (let i = 0; i <= matrix.length - 1;) {\n    const row = matrix[i];\n\n    for (let j = 0; j <= row.length - 1;) {\n      if (matrix[i + 1] === undefined) {\n        if (row[j] === row[j + 1]) {\n          return false;\n        }\n      }\n\n      if (i === 3) {\n        if (row[j] === row[j + 1]\n          || row[j + 1] === row[j + 2]\n          || row[j + 2] === row[j + 3]) {\n          return false;\n        }\n\n        return true;\n      }\n\n      if (j === 3) {\n        if (row[j] === matrix[i + 1][j]\n          || row[j] === matrix[i + 1][j]) {\n          return false;\n        }\n        j++;\n        continue;\n      }\n\n      if (row[j] === row[j + 1]\n        || row[j] === matrix[i + 1][j]) {\n        return false;\n      }\n\n      j++;\n    }\n    i++;\n  }\n\n  return true;\n}\n\nfunction isYouWin() {\n  for (let i = 0; i < matrix.length; i++) {\n    for (let j = 0; j < matrix[i].length; j++) {\n      if (+matrix[i][j] >= 2048) {\n        youWin.classList.remove('hidden');\n      }\n    }\n  }\n}\n\ndocument.addEventListener('keydown', (event) => {\n  const eventCode = event.code;\n\n  switch (eventCode) {\n    case 'ArrowRight':\n      keyRight();\n      break;\n    case 'ArrowLeft':\n      keyLeft();\n      break;\n    case 'ArrowUp':\n      keyUp();\n      break;\n    case 'ArrowDown':\n      keyDown();\n      break;\n  }\n});\n\nfunction keyRight() {\n  combineRowRight();\n  render();\n  countBusyCell = lookChanged();\n  generateNumInCell();\n}\n\nfunction keyLeft() {\n  rotateMatrix(matrix);\n  rotateMatrix(matrix);\n  combineRowRight();\n  rotateMatrix(matrix);\n  rotateMatrix(matrix);\n  render();\n  countBusyCell = lookChanged();\n  generateNumInCell();\n}\n\nfunction keyUp() {\n  rotateMatrix(matrix);\n  combineRowRight();\n  rotateMatrix(matrix);\n  rotateMatrix(matrix);\n  rotateMatrix(matrix);\n  render();\n  countBusyCell = lookChanged();\n  generateNumInCell();\n}\n\nfunction keyDown() {\n  rotateMatrix(matrix);\n  rotateMatrix(matrix);\n  rotateMatrix(matrix);\n  combineRowRight();\n  rotateMatrix(matrix);\n  render();\n  countBusyCell = lookChanged();\n  generateNumInCell();\n}\n"]}